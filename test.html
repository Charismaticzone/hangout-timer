<!DOCTYPE html>
<html>
<body>
	<h3>Hangout Timer</h3>
	<p>You can close this panel by clicking on the Hourglass icon, on the app list (left of the screen).
	<canvas id="img" width="320" height="180"></canvas>
	<!--<script src="Hourglass.js"></script>-->
	<script>
		var include = (function(){
			var FINAL_STATES = {"loaded": true, "complete": true, 4: true},
				head = document.getElementsByTagName("head")[0],
				pending = {};
			return function(src, cb){
				if (pending[src]) return;
				pending[src] = true;
				var inc = document.createElement("script");
				inc.onload = inc.onreadystatechange = function() {
					if (pending[src] && (!inc.readyState || FINAL_STATES[inc.readyState])) {
						cb && cb();
						delete pending[src];
					}
				};
				inc.src = src;
				head.appendChild(inc);
			};
		})();

		var DURATION = 5 * 1000, // 5 seconds
			CANVAS = document.getElementById("img");

		include("Hourglass.js?_t" + Date.now(), function(){
			var hourglass = new Hourglass(CANVAS);
			var stopwatch = new Stopwatch();
			stopwatch.reset(DURATION);
			stopwatch.handler = function(){
				console.log("watch", stopwatch.elapsed);
				hourglass.drawToDataUrl(stopwatch.elapsed / DURATION);
			};
			stopwatch.start();
		});
	</script>
</body>
</html>